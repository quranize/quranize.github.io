<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="icon" type="image/png" sizes="32x32"
        href="https://raw.githubusercontent.com/alpancs/quranize-service/master/public/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16"
        href="https://raw.githubusercontent.com/alpancs/quranize-service/master/public/favicon-16x16.png">

    <title>Mini Quranize</title>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">
    <style>
        [v-cloak] {
            display: none;
        }

        @font-face {
            font-family: me_quran;
            font-display: swap;
            src: url(https://raw.githubusercontent.com/alpancs/quranize-service/master/public/me_quran.ttf);
        }

        .quran-text {
            font-family: me_quran;
            line-height: 1.5em;
            direction: rtl;
        }
    </style>

    <script src="https://kit.fontawesome.com/3c11d55c8a.js" crossorigin="anonymous"></script>
    <script src="https://unpkg.com/vue@3.2.36/dist/vue.global.prod.js"></script>
    <script type="module">
        import init, { Quranize } from "./pkg/quranize.js";
        await init();
        const quranize = new Quranize(5);
        Vue.createApp({
            data() {
                return {
                    transliteration: "",
                };
            },
            computed: {
                encodeResults() {
                    return quranize.encode(this.transliteration);
                },
            },
            methods: {
                highlighted(quran_clean, location) {
                    let word_start = location.word_number - 1;
                    let word_length = quran_clean.split(" ").length;
                    let splitted = location.enhanced_quran.split(" ");
                    splitted[word_start] = "<mark>" + splitted[word_start];
                    splitted[word_start + word_length - 1] += "</mark>";
                    return splitted.join(" ");
                },
            },
            mounted() {
                this.$refs.transliteration.focus();
            },
        }).mount('#quranize-app');
    </script>
</head>

<body>
    <section class="section">
        <div class="container">
            <h1 class="title">Mini Quranize</h1>
            <h2 class="subtitle">search in the alquran using alphabet keywords</h2>
        </div>
    </section>

    <section class="section" id="quranize-app">
        <div v-show="false" class="container content">
            <p>preparing the app ‚è≥</p>
        </div>
        <div class="container block" v-cloak>
            <div class="control has-icons-left">
                <input :value="transliteration" @input="transliteration = $event.target.value" ref="transliteration"
                    class="input" type="text" placeholder="subhanallah">
                <span class="icon is-left">
                    <i class="fa-solid fa-magnifying-glass"></i>
                </span>
            </div>
        </div>
        <div class="container" v-cloak>
            <nav class="panel" v-for="encodeResult in encodeResults">
                <p class="panel-heading quran-text">
                    {{ encodeResult.quran }}
                    <span class="tag is-light is-rounded">{{ encodeResult.locations.length }}</span>
                </p>
                <label class="panel-block quran-text" v-for="location in encodeResult.locations">
                    <span v-html="highlighted(encodeResult.quran, location)"></span>
                    <span class="tag">{{location.sura_number}}:{{location.aya_number}}</span>
                </label>
            </nav>
        </div>
    </section>
</body>

</html>
